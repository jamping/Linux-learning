Nagios â€“ Installing Nagios Core From Source for Centos 7

1)Package requirements may vary depending on what type of installation platform Nagios is being installed on.   
yum install -y wget httpd php gcc glibc glibc-common gd gd-devel make net-snmp unzip mariadb mariadb-server mariadb-devel

2)Download Nagios Core and Nagios Plugins Tarball
   wget https://assets.nagios.com/downloads/nagioscore/releases/nagios-4.3.4.tar.gz
   wget https://nagios-plugins.org/download/nagios-plugins-2.2.1.tar.gz

3)Adding the Nagios User and Group

useradd nagios
groupadd nagcmd
usermod -a -G nagcmd nagios

usermod -a -G nagios,nagcmd apache

4)Nagios Core Installation,extract the package contents:

tar zxvf nagios-4.3.4.tar.gz 
tar zxvf nagios-plugins-2.2.1.tar.gz 

5)Change to the new Nagios directory and install the packages:
cd nagios-4.3.4

For RHEL/CentOS users:
./configure --with-command-group=nagcmd 

6)All systems:
make all
make install 
make install-init 
make install-config 
make install-commandmode 
make install-webconf 

cp -R contrib/eventhandlers/ /usr/local/nagios/libexec/
chown -R nagios:nagios /usr/local/nagios/libexec/eventhandlers /usr/local/nagios/bin/nagios -v /usr/local/nagios/etc/nagios.cfg

7)Create a Default User for Web Access. Add a default user for Web Interface Access:

htpasswd -c /usr/local/nagios/etc/htpasswd.users nagiosadmin

8)Nagios Plugin Installation
cd /tmp/nagios-plugins-2.2.1
./configure --with-nagios-user=nagios --with-nagios-group=nagios 

make all
make install 

Nagios Service Setup,The following commands will register the Nagios daemon to be run upon system startup.  

/etc/init.d/nagios start
chkconfig --add nagios
chkconfig --level 35 nagios on

systemctl start httpd
systemctl enable httpd

firewall-cmd --add-service=http --permanent
firewall-cmd --reload

9)NDOUtils install
wget https://sourceforge.net/projects/nagios/files/ndoutils-2.x/ndoutils-2.1.3/ndoutils-2.1.3.tar.gz

# tar -zxvf ndoutils-2.1.3.tar.gz
# cd ndoutils-2.1.3/

# vi include/config.h
#include
#include

# ./configure CFLAGS=-fPIC

# make all

# make install

Start the mysql server,Create the database ndodb

systemctl start mariadb
systemctl enable mariadb

set the root  passwd and clear test database
mysql_secure_installation

mysql -uroot -p
create database ndodb;
grant all privileges on ndodb.* to ndodb@'localhost' identified by 'wbgsnmm';
flush privileges;

Next step should be the database initialization/upgrade
cd into the db/ directory and either:
./installdb (for a new installation) or:
./upgradedb (for an existing one) 

./installdb -u ndodb -p passwd -h localhost -d ndodb;